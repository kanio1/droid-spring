# Kafka 4.0 KRaft Configuration - Broker 1
# Target: 1M+ messages/sec with 100+ partitions

# ============================================================================
# BROKER ID & CLUSTER CONFIGURATION
# ============================================================================
# Unique broker ID (0-255)
broker.id=1

# Node ID in KRaft mode (different from broker.id)
node.id=1

# Process roles: broker, controller (combined mode)
process.roles=broker,controller

# Controller quorum voters (all 3 brokers in cluster)
controller.quorum.voters=1@kafka-1:9093,2@kafka-2:9093,3@kafka-3:9093

# ============================================================================
# LISTENERS CONFIGURATION
# ============================================================================
# Internal listener (broker-to-broker)
listeners=PLAINTEXT://kafka-1:9092,CONTROLLER://kafka-1:9093

# External listener (for producers/consumers)
# advertised.listeners=PLAINTEXT://kafka-1:9092

# Listener security protocol map
listener.security.protocol.map=PLAINTEXT:PLAINTEXT,CONTROLLER:PLAINTEXT

# Inter-broker listener name
inter.broker.listener.name=PLAINTEXT

# Controller listener name
controller.listener.names=CONTROLLER

# ============================================================================
# LOG CONFIGURATION
# ============================================================================
# Log directories (KRaft uses combined logs)
log.dirs=/tmp/kraft-combined-logs

# Number of log partitions per topic (default)
num.partitions=100

# Default replication factor
default.replication.factor=3

# Minimum in-sync replicas
min.insync.replicas=2

# ============================================================================
# TOPIC CONFIGURATION
# ============================================================================
# Auto-create topics
auto.create.topics.enable=true

# Delete topics
delete.topic.enable=true

# Topic creation policy
num.topic.creation.check=3

# ============================================================================
# LOG RETENTION
# ============================================================================
# Log retention hours (7 days)
log.retention.hours=168

# Log retention size (1GB)
log.retention.bytes=1073741824

# Log retention check interval (5 minutes)
log.retention.check.interval.ms=300000

# Log segment size (1GB)
log.segment.bytes=1073741824

# Log cleanup policy
log.cleanup.policy=delete

# ============================================================================
# COMPRESSION
# ============================================================================
# Compression type: snappy (fast, good compression)
compression.type=snappy

# ============================================================================
# BATCH & THROUGHPUT TUNING
# ============================================================================
# Batch size (1MB)
batch.size=1048576

# Linger time (5ms) - wait for batch to fill
linger.ms=5

# Buffer memory (64MB)
buffer.memory=67108864

# Request timeout
request.timeout.ms=30000

# ============================================================================
# NETWORK & I/O THREADS
# ============================================================================
# Network threads (handle requests)
num.network.threads=32

# I/O threads (handle disk I/O)
num.io.threads=64

# Socket send buffer
socket.send.buffer.bytes=102400

# Socket receive buffer
socket.receive.buffer.bytes=102400

# Max socket request size (100MB)
socket.request.max.bytes=104857600

# ============================================================================
# PERFORMANCE & JVM
# ============================================================================
# JVM performance options
KAFKA_JVM_PERFORMANCE_OPTS=-Xms1g -Xmx1g -XX:+UseG1GC -XX:+UseStringDeduplication -XX:MaxGCPauseMillis=20 -XX:InitiatingHeapOccupancyPercent=35

# Log message format
log.message.format.version=3.6

# Inter-broker protocol version
inter.broker.protocol.version=3.6

# Controller protocol version
controller.protocol.version=3.6

# ============================================================================
# GROUP COORDINATION
# ============================================================================
# Group coordinator settings
group.initial.rebalance.delay.ms=3
group.max.session.timeout.ms=1800000
group.min.session.timeout.ms=6000

# ============================================================================
# OFFSET MANAGEMENT
# ============================================================================
# Offset commit settings
offsets.commit.required.acks=true
offsets.commit.timeout.ms=5000

# Offset retention
offsets.retention.minutes=10080

# ============================================================================
# PRODUCER ACKS
# ============================================================================
# Acknowledgment level
acks=all

# Retries
retries=2147483647

# Max in-flight requests
max.in.flight.requests.per.connection=5

# Enable idempotence
enable.idempotence=true

# ============================================================================
# CLEANUP & COMPACTION
# ============================================================================
# Log cleaner enabled
log.cleaner.enable=true

# Log cleaner threads
log.cleaner.threads=4

# Compaction policy
log.cleanup.policy=delete

# Delete retention (for compacted topics)
delete.retention.ms=86400000

# Min compaction lag
min.compaction.lag.ms=0

# ============================================================================
# METRICS & MONITORING
# ============================================================================
# Metric reporters
metric.reporters=org.apache.kafka.common.metrics.JmxReporter

# Auto create metrics
auto.include.jmx.reporter=true

# ============================================================================
# ZK / KRaft - Not needed in KRaft mode
# ============================================================================
# zookeeper.connect= (not used in KRaft mode)
# num.zookeeper.failure.max.attempts (not used in KRaft mode)

# ============================================================================
# SECURITY (disabled for dev environment)
# ============================================================================
# security.inter.broker.protocol=PLAINTEXT
# sasl.enabled.mechanisms= (not used in dev)

# ============================================================================
# CONTROLLER QUORUM
# ============================================================================
# Controller listeners are defined above
# This is just for documentation

# ============================================================================
# QUOTA CONFIGURATION
# ============================================================================
# Producer quota
quota.producer.default=1073741824
# Consumer quota
quota.consumer.default=1073741824

# ============================================================================
# TRANSACTIONS (for exactly-once semantics)
# ============================================================================
# Enable transactions
transactional.id.expiration.ms=604800000
# Max transaction timeout
max.transaction.timeout.ms=900000

# ============================================================================
# OTHER SETTINGS
# ============================================================================
# Authorizer class
authorizer.class.name=

# Super users
# super.users=User:admin

# Connection limit per IP
connection.limit.per.ip=2147483647
