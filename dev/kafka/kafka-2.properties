# Kafka 4.0 KRaft Configuration - Broker 2
# Target: 1M+ messages/sec with 100+ partitions

# ============================================================================
# BROKER ID & CLUSTER CONFIGURATION
# ============================================================================
broker.id=2
node.id=2
process.roles=broker,controller
controller.quorum.voters=1@kafka-1:9093,2@kafka-2:9093,3@kafka-3:9093

# ============================================================================
# LISTENERS CONFIGURATION
# ============================================================================
listeners=PLAINTEXT://kafka-2:9092,CONTROLLER://kafka-2:9093
# advertised.listeners=PLAINTEXT://kafka-2:9092
listener.security.protocol.map=PLAINTEXT:PLAINTEXT,CONTROLLER:PLAINTEXT
inter.broker.listener.name=PLAINTEXT
controller.listener.names=CONTROLLER

# ============================================================================
# LOG CONFIGURATION
# ============================================================================
log.dirs=/tmp/kraft-combined-logs
num.partitions=100
default.replication.factor=3
min.insync.replicas=2

# ============================================================================
# TOPIC CONFIGURATION
# ============================================================================
auto.create.topics.enable=true
delete.topic.enable=true
num.topic.creation.check=3

# ============================================================================
# LOG RETENTION
# ============================================================================
log.retention.hours=168
log.retention.bytes=1073741824
log.retention.check.interval.ms=300000
log.segment.bytes=1073741824
log.cleanup.policy=delete

# ============================================================================
# COMPRESSION
# ============================================================================
compression.type=snappy

# ============================================================================
# BATCH & THROUGHPUT TUNING
# ============================================================================
batch.size=1048576
linger.ms=5
buffer.memory=67108864
request.timeout.ms=30000

# ============================================================================
# NETWORK & I/O THREADS
# ============================================================================
num.network.threads=32
num.io.threads=64
socket.send.buffer.bytes=102400
socket.receive.buffer.bytes=102400
socket.request.max.bytes=104857600

# ============================================================================
# PERFORMANCE & JVM
# ============================================================================
KAFKA_JVM_PERFORMANCE_OPTS=-Xms1g -Xmx1g -XX:+UseG1GC -XX:+UseStringDeduplication -XX:MaxGCPauseMillis=20 -XX:InitiatingHeapOccupancyPercent=35
log.message.format.version=3.6
inter.broker.protocol.version=3.6
controller.protocol.version=3.6

# ============================================================================
# GROUP COORDINATION
# ============================================================================
group.initial.rebalance.delay.ms=3
group.max.session.timeout.ms=1800000
group.min.session.timeout.ms=6000

# ============================================================================
# OFFSET MANAGEMENT
# ============================================================================
offsets.commit.required.acks=true
offsets.commit.timeout.ms=5000
offsets.retention.minutes=10080

# ============================================================================
# PRODUCER ACKS
# ============================================================================
acks=all
retries=2147483647
max.in.flight.requests.per.connection=5
enable.idempotence=true

# ============================================================================
# CLEANUP & COMPACTION
# ============================================================================
log.cleaner.enable=true
log.cleaner.threads=4
log.cleanup.policy=delete
delete.retention.ms=86400000
min.compaction.lag.ms=0

# ============================================================================
# METRICS & MONITORING
# ============================================================================
metric.reporters=org.apache.kafka.common.metrics.JmxReporter
auto.include.jmx.reporter=true

# ============================================================================
# SECURITY
# ============================================================================
authorizer.class.name=

# ============================================================================
# QUOTA CONFIGURATION
# ============================================================================
quota.producer.default=1073741824
quota.consumer.default=1073741824

# ============================================================================
# TRANSACTIONS
# ============================================================================
transactional.id.expiration.ms=604800000
max.transaction.timeout.ms=900000

# ============================================================================
# OTHER SETTINGS
# ============================================================================
connection.limit.per.ip=2147483647
